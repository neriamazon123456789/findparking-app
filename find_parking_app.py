import streamlit as st
import time
import datetime

st.set_page_config(page_title="FindParking", page_icon="ğŸ…¿ï¸ FP", layout="centered")

# === ×©×¢×” × ×•×›×—×™×ª
×©×¢×”_× ×•×›×—×™×ª = datetime.datetime.now().hour

# === ×‘×¨×›×”
def ×§×‘×œ_×‘×¨×›×”():
    if ×©×¢×”_× ×•×›×—×™×ª < 12:
        return "â˜€ï¸! ×‘×•×§×¨ ×˜×•×‘"
    elif ×©×¢×”_× ×•×›×—×™×ª < 17:
        return "ğŸŒ¤ ! ×¦×”×¨×™×™× ×˜×•×‘×™×"
    else:
        return "ğŸŒ™ ! ×¢×¨×‘ ×˜×•×‘"

# âœ… × ×™×¨××•×œ ×›×ª×•×‘×ª â€“ ×›×“×™ ×©"×™×¤×•" ×ª××™×“ ×ª×™×—×©×‘ ×›×ª×œ ××‘×™×‘
def ×ª×§×Ÿ_×¢×™×¨_×‘×›×ª×•×‘×ª(×›×ª×•×‘×ª):
    ×›×ª×•×‘×ª = ×›×ª×•×‘×ª.replace("×ª×œ ××‘×™×‘-×™×¤×•", "×ª×œ ××‘×™×‘")
    ×›×ª×•×‘×ª = ×›×ª×•×‘×ª.replace("×™×¤×•", "×ª×œ ××‘×™×‘")
    return ×›×ª×•×‘×ª

# === ×¨×©×™××•×ª ×›×ª×•×‘×•×ª ×œ×“×•×’××”
×›×ª×•×‘×•×ª_×©××•×ª×¨_×œ×—× ×•×ª = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [3,4,6,8,9,12,13,20,33]]
×›×ª×•×‘×•×ª_×›×—×•×œ_×œ×‘×Ÿ = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in
    [1,2,5,7,10,11,14,16,18,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,
    40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,
    65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85]]
×›×ª×•×‘×•×ª_×—× ×™×”_××¡×•×¨×” = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [15,17,19]]

# ×”×¨×—×‘×•×ª ×œ×¨×—×•×‘ ×¨×‘×™ ×˜×¨×¤×•×Ÿ
×›×ª×•×‘×•×ª_×©××•×ª×¨_×œ×—× ×•×ª += [f"×¨×‘×™ ×˜×¨×¤×•×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [1, 3, 5]]
×›×ª×•×‘×•×ª_×›×—×•×œ_×œ×‘×Ÿ += [f"×¨×‘×™ ×˜×¨×¤×•×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [2, 4, 6, 7, 49]]
×›×ª×•×‘×•×ª_×—× ×™×”_××¡×•×¨×” += [f"×¨×‘×™ ×˜×¨×¤×•×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [9]]

# === ××ª×—×•×œ ××¦×‘
×‘×¨×™×¨×ª_××—×“×œ = {
    "×›×ª×•×‘×ª": "",
    "×”×™×¡×˜×•×¨×™×”": [],
    "××•×¢×“×¤×™×": [],
    "×›×ª×•×‘×ª_×œ×‘×—×™×¨×”": None,
    "×˜×™×™××¨_×¤×¢×™×œ": False,
    "×–××Ÿ_×©× ×™×•×ª": 0
}
for key, val in ×‘×¨×™×¨×ª_××—×“×œ.items():
    if key not in st.session_state:
        st.session_state[key] = val

# === ×¢×“×›×•×Ÿ ×× × ×‘×—×¨×” ×›×ª×•×‘×ª ××”×™×¡×˜×•×¨×™×”
if st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"]:
    st.session_state["×›×ª×•×‘×ª"] = st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"]
    st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"] = None

# === ×›×•×ª×¨×ª ×•×‘×¨×›×”
st.markdown("<h1 style='text-align: center;'>ğŸ…¿ï¸ FP â€“ FindParking</h1>", unsafe_allow_html=True)
st.markdown(f"<h3 style='text-align: center;'>{×§×‘×œ_×‘×¨×›×”()}</h3>", unsafe_allow_html=True)

# === ×”×ª×¨××” ×× ××—×•×¥ ×œ×©×¢×•×ª ×—× ×™×”
if ×©×¢×”_× ×•×›×—×™×ª < 8 or ×©×¢×”_× ×•×›×—×™×ª >= 19:
    st.warning("â° ×©×¢×•×ª ×”×—× ×™×” ×”×¡×ª×™×™××• (08:00â€“19:00). ×™×™×ª×›×Ÿ ×©×¢×›×©×™×• ××¡×•×¨ ×œ×—× ×•×ª.")

st.info("ğŸ” ×”×–×Ÿ ×›×ª×•×‘×ª ×œ×‘×“×™×§×”. ×œ×“×•×’××”: '×¨×‘×™ ×˜×¨×¤×•×Ÿ 4 ×™×¤×•'")

# === ×©×“×” ×”×–× ×”
st.text_input(": ×”×–×Ÿ ××ª ×”×›×ª×•×‘×ª ×œ×‘×“×™×§×”", key="×›×ª×•×‘×ª")
if st.session_state["×›×ª×•×‘×ª"]:
    ×›×ª×•×‘×ª_×œ×•×•×™×– = st.session_state["×›×ª×•×‘×ª"]
    ×§×™×©×•×¨_×œ×•×•×™×– = f"https://waze.com/ul?q={×›×ª×•×‘×ª_×œ×•×•×™×–.replace(' ', '%20')}&navigate=yes"
    st.markdown(f"[ğŸ” ×¤×ª×— ×‘×•×•×™×–]({×§×™×©×•×¨_×œ×•×•×™×–})", unsafe_allow_html=True)

# === ×œ×—×¦×Ÿ ×‘×“×™×§×”
if st.button("ğŸ“ ×‘×“×•×§"):
    ×›×ª×•×‘×ª = ×ª×§×Ÿ_×¢×™×¨_×‘×›×ª×•×‘×ª(st.session_state["×›×ª×•×‘×ª"])
    ×›×ª×•×‘×ª = ×›×ª×•×‘×ª.strip().replace(",", "")
    ××_×œ×_×‘×”×™×¡×˜×•×¨×™×” = ×›×ª×•×‘×ª and ×›×ª×•×‘×ª not in st.session_state["×”×™×¡×˜×•×¨×™×”"]
    if ××_×œ×_×‘×”×™×¡×˜×•×¨×™×”:
        st.session_state["×”×™×¡×˜×•×¨×™×”"].insert(0, ×›×ª×•×‘×ª)

    ××_××¡×•×¨×” = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×—× ×™×”_××¡×•×¨×”)
    ××_×›×—×•×œ = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×›×—×•×œ_×œ×‘×Ÿ)
    ××_××•×ª×¨ = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×©××•×ª×¨_×œ×—× ×•×ª)

    if ××_××¡×•×¨×”:
        st.error("ğŸš« ××¡×•×¨ ×œ×—× ×•×ª ×›××Ÿ.")
    elif ××_×›×—×•×œ:
        st.success("ğŸ”µ ××•×ª×¨ ×œ×—× ×•×ª ×›××Ÿ â€“ ×—× ×™×” ×›×—×•×œÖ¾×œ×‘×Ÿ")
        st.info("ğŸ•’ ×‘×™×Ÿ 8:00 ×œÖ¾19:00")
    elif ××_××•×ª×¨:
        st.success("âœ… ××•×ª×¨ ×œ×—× ×•×ª ×›××Ÿ â€“ ×—× ×™×” ××¤×•×¨×”")
        st.info("ğŸ•’ ×‘×™×Ÿ 8:00 ×œÖ¾19:00")
    else:
        st.warning("â“ ××™×Ÿ ××™×“×¢ ×¢×œ ×”×›×ª×•×‘×ª.")

# === ×”×™×¡×˜×•×¨×™×” + ××•×¢×“×¤×™×
with st.expander("ğŸ“œ ×”×™×¡×˜×•×¨×™×™×ª ×›×ª×•×‘×•×ª + ××•×¢×“×¤×™×"):
    ×”×›×œ = st.session_state["××•×¢×“×¤×™×"] + [
        ×›×ª for ×›×ª in st.session_state["×”×™×¡×˜×•×¨×™×”"] if ×›×ª not in st.session_state["××•×¢×“×¤×™×"]
    ]

    if ×”×›×œ:
        if st.button("ğŸ§¹ × ×§×” ×”×›×œ"):
            st.session_state["×”×™×¡×˜×•×¨×™×”"].clear()
            st.session_state["××•×¢×“×¤×™×"].clear()
            st.rerun()

        for i, ×›×ª×•×‘×ª_×¢×‘×¨ in enumerate(×”×›×œ):
            ×©×•×¨×” = st.columns([6, 1])
            ×¢×_×›×•×›×‘ = ×›×ª×•×‘×ª_×¢×‘×¨ in st.session_state["××•×¢×“×¤×™×"]

            with ×©×•×¨×”[0]:
                if st.button(f"{'â­ ' if ×¢×_×›×•×›×‘ else ''}{×›×ª×•×‘×ª_×¢×‘×¨}", key=f"×”×™×¡×˜×•×¨×™×”_{i}"):
                    st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"] = ×›×ª×•×‘×ª_×¢×‘×¨
                    st.rerun()
            with ×©×•×¨×”[1]:
                if st.button("â˜…" if ×¢×_×›×•×›×‘ else "â˜†", key=f"×›×•×›×‘_{i}"):
                    if ×¢×_×›×•×›×‘:
                        st.session_state["××•×¢×“×¤×™×"].remove(×›×ª×•×‘×ª_×¢×‘×¨)
                    else:
                        st.session_state["××•×¢×“×¤×™×"].insert(0, ×›×ª×•×‘×ª_×¢×‘×¨)
                    st.rerun()
    else:
        st.markdown("_××™×Ÿ ×¢×“×™×™×Ÿ ×”×™×¡×˜×•×¨×™×” ×œ×”×¦×’×”._")

# === ×˜×™×™××¨ ×—× ×™×”
st.markdown("---")
st.markdown("### â±ï¸ ×˜×™×™××¨ ×—× ×™×”")

×© = st.session_state["×–××Ÿ_×©× ×™×•×ª"] // 3600
×“ = (st.session_state["×–××Ÿ_×©× ×™×•×ª"] % 3600) // 60
×©×  = st.session_state["×–××Ÿ_×©× ×™×•×ª"] % 60
st.markdown(f"## ğŸ•’ {×©:02}:{×“:02}:{×©× :02}")

col1, col2, col3 = st.columns(3)
with col1:
    if st.button("ğŸŸ¢ ×”×ª×—×œ"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = True
with col2:
    if st.button("â¸ ×”×¤×¡×§"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = False
with col3:
    if st.button("ğŸ” ××™×¤×•×¡"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = False
        st.session_state["×–××Ÿ_×©× ×™×•×ª"] = 0

if st.session_state["×˜×™×™××¨_×¤×¢×™×œ"]:
    time.sleep(1)
    st.session_state
if st.session_state["×˜×™×™××¨_×¤×¢×™×œ"]:
    time.sleep(1)
    st.session_state["×–××Ÿ_×©× ×™×•×ª"] += 1
    st.rerun()

# === ×©×™×ª×•×£ ×•××•×“×•×ª ===
st.markdown("---")
st.markdown("### ğŸ”— ×©×ª×¤×• ××ª ×”××¤×œ×™×§×¦×™×” ×¢× ×—×‘×¨×™×:")

×§×™×©×•×¨ = "https://neriamazon123456789-findparking-app.streamlit.app"

st.code(×§×™×©×•×¨, language="markdown")

col1, col2, col3 = st.columns(3)
with col1:
    st.markdown(
        f"[ğŸ“² ×©×œ×— ×‘×•×•××˜×¡××¤](https://wa.me/?text=××¦××ª×™%20××¤×œ×™×§×¦×™×”%20×œ××¦×•×%20×—× ×™×”!%20{×§×™×©×•×¨})",
        unsafe_allow_html=True
    )
with col2:
    st.markdown(
        f"[ğŸ“© ×©×œ×— ×‘××™×™×œ](mailto:?subject=××¦××ª×™%20××¤×œ×™×§×¦×™×”%20×œ××¦×•×%20×—× ×™×”!&body={×§×™×©×•×¨})",
        unsafe_allow_html=True
    )
with col3:
    st.markdown(f"[ğŸŒ ××¢×‘×¨ ×œ××¤×œ×™×§×¦×™×”]({×§×™×©×•×¨})", unsafe_allow_html=True)

st.markdown("---")
st.markdown("### â„¹ï¸ ××•×“×•×ª")
st.markdown("""
××¤×œ×™×§×¦×™×™×ª **FindParking FP** ×¤×•×ª×—×” ×›×›×œ×™ ×¢×–×¨ ×œ××™×ª×•×¨ ×—× ×™×” ×‘×¨×—×•×‘×•×ª ××¡×•×™××™× ×‘×ª×œ ××‘×™×‘.  
ğŸš§ *×–×•×”×™ ×’×¨×¡×ª ×“××• × ×™×¡×™×•× ×™×ª ×œ×¦×•×¨×›×™ ×”××—×©×” ×‘×œ×‘×“.*  
ğŸ›‘ *××™×Ÿ ×œ×¨××•×ª ×‘××™×“×¢ ×ª×—×œ×™×£ ×œ×ª××¨×•×¨×™× ×‘×¤×•×¢×œ.*  

×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª Â© 2025  
×¤×•×ª×— ×¢×œ ×™×“×™ [× ×¨×™×” ××–×•×Ÿ](https://github.com/neriamazon123456789)
""")
with st.expander("ğŸ”§ ××¦×‘ ×¤× ×™××™ (session_state)", expanded=False):
    st.write(st.session_state)
with st.expander("ğŸ”§ ××¦×‘ ×¤× ×™××™ (session_state)", expanded=False):
    st.json(st.session_state)  # ××¦×™×’ ×‘×¦×•×¨×” ×‘×¨×•×¨×” ×•××¡×•×“×¨×ª



















