import streamlit as st
import time
import datetime

st.set_page_config(page_title="FindParking", page_icon="ğŸ…¿ï¸", layout="centered")

# === ×‘×¨×›×” ×œ×¤×™ ×©×¢×” ===
def ×§×‘×œ_×‘×¨×›×”():
    ×©×¢×” = datetime.datetime.now().hour
    if ×©×¢×” < 12:
        return "â˜€ï¸ ×‘×•×§×¨ ×˜×•×‘!"
    elif ×©×¢×” < 17:
        return "ğŸŒ¤ ×¦×”×¨×™×™× ×˜×•×‘×™×!"
    else:
        return "ğŸŒ™ ×¢×¨×‘ ×˜×•×‘!"

# === ×××’×¨×™ ×›×ª×•×‘×•×ª ×œ×“×•×’××” ===
×›×ª×•×‘×•×ª_×©××•×ª×¨_×œ×—× ×•×ª = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [3, 4, 6, 8, 13, 20, 33, 43]]
×›×ª×•×‘×•×ª_×›×—×•×œ_×œ×‘×Ÿ = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [1,2,5,7,10,11,14,16,18,21,23,25,27,29,30,31,34,36,38,40,41,44,46,48,50,54,56,58,60]]
×›×ª×•×‘×•×ª_×—× ×™×”_××¡×•×¨×” = [f"××©×” ×“×™×™×Ÿ {x} ×ª×œ ××‘×™×‘" for x in [100,101]]

# === ××ª×—×•×œ ××©×ª× ×™× ×‘××¦×‘ ×”×’×œ×•×‘×œ×™ (session_state) ===
defaults = {
    "×›×ª×•×‘×ª": "",
    "×”×™×¡×˜×•×¨×™×”": [],
    "×›×ª×•×‘×ª_×œ×‘×—×™×¨×”": None,
    "×˜×™×™××¨_×¤×¢×™×œ": False,
    "×–××Ÿ_×©× ×™×•×ª": 0
}
for key, val in defaults.items():
    if key not in st.session_state:
        st.session_state[key] = val

# === ×× × ×‘×—×¨×” ×›×ª×•×‘×ª ××”×™×¡×˜×•×¨×™×” â€” × ×¢×“×›×Ÿ ×œ×¨×™×¦×” ×”×–×•
if st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"]:
    st.session_state["×›×ª×•×‘×ª"] = st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"]
    st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"] = None

# === ×›×•×ª×¨×•×ª ×•×¤×ª×™×— ===
st.markdown("<h1 style='text-align: center;'>ğŸ…¿ï¸ FindParking</h1>", unsafe_allow_html=True)
st.markdown(f"<h3 style='text-align: center;'>{×§×‘×œ_×‘×¨×›×”()}</h3>", unsafe_allow_html=True)
st.info("ğŸ” ×”×–×Ÿ ×›×ª×•×‘×ª ×œ×‘×“×™×§×”, ×œ×“×•×’××”: '××©×” ×“×™×™×Ÿ 10 ×ª×œ ××‘×™×‘'")

# === ×©×“×” ×”×–× ×”
st.text_input("×›×ª×•×‘×ª ×œ×‘×“×™×§×”:", key="×›×ª×•×‘×ª")

# === ×›×¤×ª×•×¨ ×‘×“×™×§×”
if st.button("ğŸ“ ×‘×“×•×§"):
    ×›×ª×•×‘×ª = st.session_state["×›×ª×•×‘×ª"].strip().replace(",", "")
    if not ×›×ª×•×‘×ª:
        st.warning("âš ï¸ ×× × ×”×–×Ÿ ×›×ª×•×‘×ª.")
    else:
        if ×›×ª×•×‘×ª not in st.session_state["×”×™×¡×˜×•×¨×™×”"]:
            st.session_state["×”×™×¡×˜×•×¨×™×”"].insert(0, ×›×ª×•×‘×ª)

        ××_××¡×•×¨×” = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×—× ×™×”_××¡×•×¨×”)
        ××_×›×—×•×œ = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×›×—×•×œ_×œ×‘×Ÿ)
        ××_××•×ª×¨ = any(×›×ª in ×›×ª×•×‘×ª for ×›×ª in ×›×ª×•×‘×•×ª_×©××•×ª×¨_×œ×—× ×•×ª)

        if ××_××¡×•×¨×”:
            st.error("ğŸš« ××¡×•×¨ ×œ×—× ×•×ª ×›××Ÿ.")
        elif ××_×›×—×•×œ:
            st.success("ğŸ”µ ××•×ª×¨ ×œ×—× ×•×ª ×›××Ÿ â€“ ×—× ×™×” ×›×—×•×œÖ¾×œ×‘×Ÿ")
            st.info("ğŸ•’ ×‘×™×Ÿ 8:00 ×œÖ¾19:00")
        elif ××_××•×ª×¨:
            st.success("âœ… ××•×ª×¨ ×œ×—× ×•×ª ×›××Ÿ â€“ ×—× ×™×” ××¤×•×¨×”")
            st.info("ğŸ•’ ×‘×™×Ÿ 8:00 ×œÖ¾19:00")
        else:
            st.warning("â“ ××™×Ÿ ××™×“×¢ ×¢×œ ×”×›×ª×•×‘×ª.")

# === ×”×™×¡×˜×•×¨×™×™×ª ×—×™×¤×•×©×™× ===
with st.expander("ğŸ“œ ×”×™×¡×˜×•×¨×™×™×ª ×›×ª×•×‘×•×ª"):
    if st.session_state["×”×™×¡×˜×•×¨×™×”"]:
        for i, ×›×ª×•×‘×ª_×¢×‘×¨ in enumerate(st.session_state["×”×™×¡×˜×•×¨×™×”"]):
            if st.button(×›×ª×•×‘×ª_×¢×‘×¨, key=f"×”×™×¡×˜×•×¨×™×”_{i}"):
                st.session_state["×›×ª×•×‘×ª_×œ×‘×—×™×¨×”"] = ×›×ª×•×‘×ª_×¢×‘×¨
                st.rerun()
    else:
        st.markdown("_××™×Ÿ ×¢×“×™×™×Ÿ ×”×™×¡×˜×•×¨×™×”._")

# === ×˜×™×™××¨ ×—× ×™×” ===
st.markdown("---")
st.markdown("### â±ï¸ ×˜×™×™××¨ ×—× ×™×”")

# ×ª×¦×•×’×ª ×–××Ÿ
×©×¢×•×ª = st.session_state["×–××Ÿ_×©× ×™×•×ª"] // 3600
×“×§×•×ª = (st.session_state["×–××Ÿ_×©× ×™×•×ª"] % 3600) // 60
×©× ×™×•×ª = st.session_state["×–××Ÿ_×©× ×™×•×ª"] % 60
st.markdown(f"## ğŸ•’ {×©×¢×•×ª:02}:{×“×§×•×ª:02}:{×©× ×™×•×ª:02}")

# ×›×¤×ª×•×¨×™×: ×”×ª×—×œ×” / ×¢×¦×™×¨×” / ××™×¤×•×¡
col1, col2, col3 = st.columns(3)
with col1:
    if st.button("ğŸŸ¢ ×”×ª×—×œ"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = True
with col2:
    if st.button("â¸ ×”×¤×¡×§"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = False
with col3:
    if st.button("ğŸ” ××™×¤×•×¡"):
        st.session_state["×˜×™×™××¨_×¤×¢×™×œ"] = False
        st.session_state["×–××Ÿ_×©× ×™×•×ª"] = 0

# ×”×¤×¢×œ×ª ×¡×¤×™×¨×” ×¢× ×¨×¢× ×•×Ÿ ××•×˜×•××˜×™
if st.session_state["×˜×™×™××¨_×¤×¢×™×œ"]:
    time.sleep(1)
    st.session_state["×–××Ÿ_×©× ×™×•×ª"] += 1
    st.rerun()













